(function(){for(var m,aa="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)},v="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global?global:this,w=["String","prototype","repeat"],ba=0;ba<w.length-1;ba++){var ca=w[ba];ca in v||(v[ca]={});v=v[ca]}
var da=w[w.length-1],ea=v[da],fa=ea?ea:function(a){var b;if(null==this)throw new TypeError("The 'this' value for String.prototype.repeat must not be null or undefined");b=this+"";if(0>a||1342177279<a)throw new RangeError("Invalid count value");a|=0;for(var c="";a;)if(a&1&&(c+=b),a>>>=1)b+=b;return c};fa!=ea&&null!=fa&&aa(v,da,{configurable:!0,writable:!0,value:fa});var z=this;
function ga(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function E(a){return"array"==ga(a)}function F(a){return"string"==typeof a}function ha(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}var G="closure_uid_"+(1E9*Math.random()>>>0),ia=0;function ja(a,b,c){return a.call.apply(a.bind,arguments)}
function ka(a,b,c){if(!a)throw Error();if(2<arguments.length){var e=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,e);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function la(a,b,c){la=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ja:ka;return la.apply(null,arguments)}var J=Date.now||function(){return+new Date};
function K(a,b){var c=a.split("."),e=z;c[0]in e||!e.execScript||e.execScript("var "+c[0]);for(var d;c.length&&(d=c.shift());)c.length||void 0===b?e[d]?e=e[d]:e=e[d]={}:e[d]=b}function ma(a,b){function c(){}c.prototype=b.prototype;a.J=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.ha=function(a,c,f){for(var g=Array(arguments.length-2),h=2;h<arguments.length;h++)g[h-2]=arguments[h];return b.prototype[c].apply(a,g)}};function oa(a,b,c){for(var e in a)b.call(c,a[e],e,a)}var pa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function qa(a,b){for(var c,e,d=1;d<arguments.length;d++){e=arguments[d];for(c in e)a[c]=e[c];for(var f=0;f<pa.length;f++)c=pa[f],Object.prototype.hasOwnProperty.call(e,c)&&(a[c]=e[c])}};function L(a,b,c,e,d){return{siteId:a,seqId:b,context:c,invCount:e||0,load:d||null}}K("cot.operation",L);function M(){return{vector:{},size:0}}M.l=function(a,b){var c=a.vector[b];c||(c=a.vector[b]=M.h(),a.size++);return c};M.h=function(a,b,c){return{seqId:a||0,invCluster:b||{},invClusterSize:c||0}};M.f=function(a,b){var c=a.vector[b];return c?c.seqId:0};M.c=function(a,b,c){return(a=a.vector[b])&&a.invCluster[c]||0};
M.a=function(a,b,c,e){var d;F(b)?(d=b,c=c||0,b=e||0):(d=b.siteId,c=b.seqId,b=b.invCount);a=M.l(a,d);a.seqId=Math.max(c,a.seqId);b&&(d=a.invCluster[c],d||(d=0,a.invClusterSize++),a.invCluster[c]=Math.max(b,d))};M.j=function(a,b,c){var e;F(b)?(e=b,b=c||0):(e=b.siteId,b=b.seqId);a=M.l(a,e);a.seqId==b&&a.seqId--;b in a.invCluster&&(delete a.invCluster[b],a.invClusterSize--)};
M.clone=function(a){var b=M(),c;for(c in a.vector){var e=a.vector[c],d=e.invCluster,f={},g=void 0;for(g in d)f[g]=d[g];b.vector[c]=M.h(e.seqId,f,e.invClusterSize)}b.size=a.size;return b};M.b=function(a,b){if(a.size<b.size)return!1;for(var c in b.vector){var e=a.vector[c],d=b.vector[c];if(!e||e.seqId<d.seqId||e.invClusterSize<d.invClusterSize)return!1;var e=e.invCluster,d=d.invCluster,f;for(f in d)if((e[+f]||0)<d[+f])return!1}return!0};
M.i=function(a,b){if(a.size!=b.size)return!1;for(var c in b.vector){var e=a.vector[c],d=b.vector[c];if(!e||e.seqId!=d.seqId||e.invClusterSize!=d.invClusterSize)return!1;var e=e.invCluster,d=d.invCluster,f;for(f in d)if((e[+f]||0)!=d[+f])return!1}return!0};M.m=function(a,b){return!M.b(a,b)&&!M.b(b,a)};
M.g=function(a,b){var c={},e=0,d;for(d in a.vector){var f=a.vector[d],g=b.vector[d],h=f.seqId,k=f.invCluster;g?(f=g.seqId,g=g.invCluster):(f=0,g={});var l=[],n=[],p={},r=0,q;for(q in k){q=+q;var C=k[q],D=C-(g[q]||0);0<D&&D&1&&(q>f?(p[q]=!0,r++):C&1?l.push(q):n.push(q))}if(f<h||r||l.length||n.length)l.sort(),n.sort(),c[d]={N:f+1,R:h,s:l,C:n,Y:r?p:null},e++}return e?c:null};M.getSeqId=M.f;M.getInvCount=M.c;M.include=M.a;M.exclude=M.j;M.clone=M.clone;M.includes=M.b;M.equals=M.i;M.isParallelTo=M.m;
M.subtract=M.g;K("cot.context",M);var ra=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};function sa(a,b){return a<b?-1:a>b?1:0};function ta(a,b,c){this.j=a;this.g=b;this.a=c?c:M();this.f=M.clone(this.a);this.c={};this.i={};this.h=0;for(var e in this.a.vector)ua(this,e)}function va(a,b){var c=a.siteId;return c==b.siteId?M.f(a.context,c)-M.f(b.context,c):c>b.siteId?1:-1}function wa(a,b){return b-a}
ta.prototype.s=function(a){var b=a.ops,c=a.context,e=a.siteId;ua(this,e);var d={},f;if(E(b))for(f=M.f(c,e),c=0;c<b.length;c++)f++,d[f]=M.c(this.a,e,f)+1;else if(ha(b))for(f in b)d[f]=M.c(this.a,e,+f)+1;a={docId:a.docId,siteId:e,context:M.clone(this.a),ops:d};xa(this,a);b=ya(this);return[a,b[0],b[1]]};
function ya(a){for(var b=za(a,a.f,a.a),c=b[0],e=b[1],b=[],d=0;d<c.length;d++){var e=Aa(a,c[d],a.a,e),f=e[0],e=e[1];if(f)M.a(a.a,f),null!=f.load&&b.push(f);else break}if(e){a={};for(var g in e){var c=e[g],d=[],h;for(h in c)d.push(+h);d.length&&(d.sort(),a[g]=d)}}else a=null;return[b,a]}
function xa(a,b){if(M.g(b.context,a.f))a.b||(a.b=[]),a.b.push(b);else{Ba(a,b);if(a.b&&a.b.length){var c=a.b;c.sort(va);for(var e=[],d=0;d<c.length;d++)b=c[d],Ba(a,b)||e.push(b);a.b=e.length?e:null}return!0}return!1}
function Ba(a,b){var c=b.ops,e=b.siteId;ua(a,e);var d;if(E(c)){var f=a.c[e];f||(f=a.c[e]=new Ca);var g=M.clone(b.context),h=M.f(g,e);for(d=0;d<c.length;d++){var k=L(e,++h,M.clone(g),0,c[d]),l=f,n=k,p=n.seqId,r=!1;if(!l.c[p-l.a]&&(isNaN(l.a)||p==l.a-1?(l.c.unshift(Da(n)),l.a=p,r=p==l.h+1):p==l.a+l.c.length?(l.c.push(Da(n)),r=p==l.g-1):p<l.a?(l.b?l.b.push(n):l.b=[n],l.h=Math.max(l.h,p)):(l.f?l.f.push(n):l.f=[n],l.g=Math.min(l.g,p)),r)){if(n=l.b.length){for(l.b.sort(Ea);p=l.b[l.b.length-1];)if(p.seqId==
l.a-1)l.c.unshift(Da(p)),l.b.pop(),l.a--;else break;l.h=l.b.length?l.b[l.b.length].seqId:-Infinity}if(n=l.f.length){l.f.sort(Ea);for(var r=l.a+l.c.length,q=0;q<n;q++)if(p=l.f[q],p.seqId==r)l.c.push(Da(p)),r++;else{l.f.splice(q,n-q);break}q==n?(l.f.length=0,l.g=Infinity):l.g=l.f[0].seqId}}M.a(g,k);M.a(a.f,k)}}else if(ha(c))for(d in c)M.a(a.f,e,+d,c[d])}function ua(a,b){a.i[b]||(a.i[b]=!0,a.h++)}
function Aa(a,b,c,e){var d;if(E(c))d=c;else{var f=za(a,c,b.context);if(c=f[1]){e||(e={});for(d in c)if(a=e[d],b=c[d],a)for(var g in b)a[+g]=!0;else e[d]=b;return[null,e]}d=f[0]}if(null!=b.load){if(d.length&&b.invCount&1){a:{c=a.g(b);g=M.clone(b.context);M.j(g,b);c=L(b.siteId,b.seqId,g,0,c);for(var h=[],f=[],k=0;k<d.length;k++)M.m(g,d[k].context)?h.push(d[k]):f.push(d[k]);if(h.length)if(e=Aa(a,c,h,e),c=e[0],e=e[1],c)g=c.context,M.a(g,b.siteId,b.seqId,0),b.load=a.g(c),b.context=g;else{e=[null,f,e];
break a}e=[b,f,e]}b=e[0];d=e[1];e=e[2];if(!b)return[null,e]}for(g=0;g<d.length;g++){c=d[g];if(f=k=a.c[c.siteId])a:{f=c;h=b.context;if((k=k.c[f.seqId-k.a]||null)&&k.cache)for(var k=k.cache,l=0;l<k.length;l++){var n=k[l];if(!(!!(f.invCount&1)^n.X)&&M.i(h,k[l].context)){f=L(f.siteId,f.seqId,M.clone(h),f.invCount,n.load);break a}}f=null}if(f=f||null)c=f;else if(e=Aa(a,c,b.context,e),c=e[0],e=e[1],!c)return[null,e];null!=b.load&&null!=c.load&&(f=a.j(b,c),h=a.j(c,b),b.load=f,c.load=h);M.a(b.context,c);
Fa(a,b);M.a(c.context,b);Fa(a,c)}}else if(d.length)for(g=0;g<d.length;g++)c=d[g],M.a(b.context,c),Fa(a,b),M.a(c.context,b),Fa(a,c);return[b,e]}
function za(a,b,c){var e=M.g(b,c);if(e){var d,f,g={},h=null,k;for(k in e){var l=e[k],n=l.N,p=l.R,r=[],q=[],C=a.c[k]||null;l.s.sort(wa);l.C.sort();var D=l.s.concat(l.C);for(f=0;f<D.length;f++)d=D[f],Ga(a,C,k,d,r,q,M.c(b,k,d),!1);f=l.Y;for(d=n;d<=p;d++)Ga(a,C,k,d,r,q,M.c(b,k,d),!!f&&d in f);r.length&&(g[k]=r);q.length&&(h||(h={}),h[k]=q)}a=[g,h];b=a[0];var B,e={};for(B in b)e[B]=0;d=[];for(c=M.clone(c);B=Ha(b,e,c);){g=b[B];h=e[B];k=g[h];do d.push(k),M.a(c,k),h=++e[B],k=g[h];while(h<g.length&&M.b(c,
k.context))}a[0]=d;return a}return[[],null]}function Ha(a,b,c){for(var e in a){var d=a[e],f=b[e];if(f<d.length&&M.b(c,d[f].context))return e}return null}function Ga(a,b,c,e,d,f,g,h){var k;if(k=b)k=(b=b.c[e-b.a]||null)?L(c,e,M.clone(b.context),0,b.load):null;(c=k||null)?(h?c.load=null:g&1&&(c.load=a.g(c),M.a(c.context,c)),c.invCount=g,d.push(c)):f[e]=!0}function Fa(a,b){var c=a.c[b.siteId];c&&c.cache(b,a.h)}
function Ca(){this.c=[];this.a=NaN;this.b=null;this.h=-Infinity;this.f=null;this.g=Infinity}function Ea(a,b){return a.seqId-b.seqId}Ca.prototype.cache=function(a,b){var c=this.c[a.seqId-this.a]||null;if(c){c.cache||(c.cache=[]);var e={load:a.load,X:!!(a.invCount&1),context:M.clone(a.context)};c.F=(c.F+1)%b;c.cache[c.F]=e}return!!c};function Da(a){return{load:a.load,context:M.clone(a.context),F:-1,cache:null}};function Ia(a,b){this.f=a;this.b={};this.g=b||50;this.a=[];this.c=[]}m=Ia.prototype;m.S=function(a,b){var c=[],e={},d=null;if(ha(a))for(var f in a)d=Ja(this,f,a[f],c,e,d);else F(a)&&(d=Ja(this,a,b,c,e,d));this.a.push(c);this.a.length>=this.g&&this.a.shift();this.c.length=0;return[c,e,d]};
m.V=function(a){for(var b={},c=null,e=0;e<a.length;e++){var d=a[e],f=b,g=d.docId,h=this.b[g];if(!h)throw"Cannot update a document that is not registered";if(xa(h,d))d=ya(h);else{var d=M.g(d.context,h.a),h={},k=void 0;for(k in d){for(var l=d[k],n=[],p=l.N;p<=l.R;p++)n.push(p);h[k]=n}d=[[],h]}f[g]=(f[g]||[]).concat(d[0]);d[1]&&(c||(c={}),c[g]=d[1])}return[b,c]};
m.s=function(){if(this.L()){var a=[],b={},c=null,e=this.a.pop();this.c.push(e);for(var d=0;d<e.length;d++)c=Ka(this,e[d],a,b,c);return[a,b,c]}return null};m.C=function(){if(this.K()){var a=[],b={},c=null,e=this.c.pop();this.a.push(e);for(var d=0;d<e.length;d++)c=Ka(this,e[d],a,b,c);return[a,b,c]}return null};m.L=function(){return!!this.a.length};m.K=function(){return!!this.c.length};m.U=function(a,b,c,e){this.b[a]=new ta(b,c,e)};m.T=function(a){return(a=this.b[a])&&a.a||null};m.W=function(){return this.f};
m.da=function(a){this.f=a};function Ja(a,b,c,e,d,f){var g=a.b[b];if(!g)throw"Cannot commit an operation to a document that is not registered";a=a.f;c=E(c)?c:[c];ua(g,a);c={docId:b,siteId:a,context:M.clone(g.a),ops:c};xa(g,c);g=ya(g);g=[c,g[0],g[1]];e.push(g[0]);d[b]=g[1];g[2]&&(f||(f={}),f[b]=g[2]);return f}function Ka(a,b,c,e,d){var f=b.docId;a=a.b[f];if(!a)throw"Cannot undo an operation in a document that is not registered";b=a.s(b);c.push(b[0]);e[f]=b[1];b[2]&&(d||(d={}),d[f]=b[2]);return d}
var N=Ia.prototype;N.commit=N.S;N.undo=N.s;N.redo=N.C;N.canUndo=N.L;N.canRedo=N.K;N.update=N.V;N.register=N.U;N.getState=N.T;N.id=function(a,b){return function(c){return void 0!==c?(b.call(this,c),this):a.call(this)}}(N.W,N.da);K("cot.Site",Ia);var La=Array.prototype.indexOf?function(a,b,c){return Array.prototype.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(F(a))return F(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1};var O;a:{var Ma=z.navigator;if(Ma){var Na=Ma.userAgent;if(Na){O=Na;break a}}O=""};function Oa(){0!=Pa&&(Qa[this[G]||(this[G]=++ia)]=this);this.g=this.g;this.j=this.j}var Pa=0,Qa={};Oa.prototype.g=!1;Oa.prototype.f=function(){if(this.j)for(;this.j.length;)this.j.shift()()};function Ra(a){Ra[" "](a);return a}Ra[" "]=function(){};var Sa=-1!=O.indexOf("Opera"),P=-1!=O.indexOf("Trident")||-1!=O.indexOf("MSIE"),Ta=-1!=O.indexOf("Edge"),Ua=-1!=O.indexOf("Gecko")&&!(-1!=O.toLowerCase().indexOf("webkit")&&-1==O.indexOf("Edge"))&&!(-1!=O.indexOf("Trident")||-1!=O.indexOf("MSIE"))&&-1==O.indexOf("Edge"),Va=-1!=O.toLowerCase().indexOf("webkit")&&-1==O.indexOf("Edge");function Wa(){var a=z.document;return a?a.documentMode:void 0}var Xa;
a:{var Ya="",Za=function(){var a=O;if(Ua)return/rv\:([^\);]+)(\)|;)/.exec(a);if(Ta)return/Edge\/([\d\.]+)/.exec(a);if(P)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);if(Va)return/WebKit\/(\S+)/.exec(a);if(Sa)return/(?:Version)[ \/]?(\S+)/.exec(a)}();Za&&(Ya=Za?Za[1]:"");if(P){var $a=Wa();if(null!=$a&&$a>parseFloat(Ya)){Xa=String($a);break a}}Xa=Ya}var ab={},bb=z.document,cb=bb&&P?Wa()||("CSS1Compat"==bb.compatMode?parseInt(Xa,10):5):void 0;var db;(db=!P)||(db=9<=Number(cb));var eb=db,fb;
if(fb=P){var gb;if(Object.prototype.hasOwnProperty.call(ab,"9"))gb=ab["9"];else{for(var hb=0,ib=ra(String(Xa)).split("."),jb=ra("9").split("."),kb=Math.max(ib.length,jb.length),lb=0;!hb&&lb<kb;lb++){var mb=ib[lb]||"",nb=jb[lb]||"";do{var Q=/(\d*)(\D*)(.*)/.exec(mb)||["","","",""],R=/(\d*)(\D*)(.*)/.exec(nb)||["","","",""];if(0==Q[0].length&&0==R[0].length)break;hb=sa(0==Q[1].length?0:parseInt(Q[1],10),0==R[1].length?0:parseInt(R[1],10))||sa(0==Q[2].length,0==R[2].length)||sa(Q[2],R[2]);mb=Q[3];nb=
R[3]}while(!hb)}gb=ab["9"]=0<=hb}fb=!gb}var ob=fb;function S(a,b){this.type=a;this.a=this.b=b;this.P=!0}S.prototype.c=function(){this.P=!1};function T(a,b){S.call(this,a?a.type:"");this.f=this.a=this.b=null;if(a){this.type=a.type;this.b=a.target||a.srcElement;this.a=b;var c=a.relatedTarget;if(c&&Ua)try{Ra(c.nodeName)}catch(e){}this.f=a;a.defaultPrevented&&this.c()}}ma(T,S);T.prototype.c=function(){T.J.c.call(this);var a=this.f;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,ob)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var pb="closure_listenable_"+(1E6*Math.random()|0),qb=0;function rb(a,b,c,e,d){this.listener=a;this.a=null;this.src=b;this.type=c;this.A=!!e;this.B=d;++qb;this.o=this.w=!1}function sb(a){a.o=!0;a.listener=null;a.a=null;a.src=null;a.B=null};function tb(a){this.src=a;this.a={};this.b=0}function ub(a,b,c,e,d){var f=b.toString();b=a.a[f];b||(b=a.a[f]=[],a.b++);var g=vb(b,c,e,d);-1<g?(a=b[g],a.w=!1):(a=new rb(c,a.src,f,!!e,d),a.w=!1,b.push(a));return a}function wb(a,b){var c=b.type;if(c in a.a){var e=a.a[c],d=La(e,b),f;(f=0<=d)&&Array.prototype.splice.call(e,d,1);f&&(sb(b),a.a[c].length||(delete a.a[c],a.b--))}}function vb(a,b,c,e){for(var d=0;d<a.length;++d){var f=a[d];if(!f.o&&f.listener==b&&f.A==!!c&&f.B==e)return d}return-1};var xb="closure_lm_"+(1E6*Math.random()|0),yb={},zb=0;
function Ab(a,b,c,e,d){if(E(b))for(var f=0;f<b.length;f++)Ab(a,b[f],c,e,d);else if(c=Bb(c),a&&a[pb])ub(a.b,String(b),c,e,d);else{if(!b)throw Error("Invalid event type");var f=!!e,g=Cb(a);g||(a[xb]=g=new tb(a));c=ub(g,b,c,e,d);if(!c.a){e=Db();c.a=e;e.src=a;e.listener=c;if(a.addEventListener)a.addEventListener(b.toString(),e,f);else if(a.attachEvent)a.attachEvent(Eb(b.toString()),e);else throw Error("addEventListener and attachEvent are unavailable.");zb++}}}
function Db(){var a=Fb,b=eb?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b}function Gb(a,b,c,e,d){if(E(b))for(var f=0;f<b.length;f++)Gb(a,b[f],c,e,d);else(c=Bb(c),a&&a[pb])?(a=a.b,b=String(b).toString(),b in a.a&&(f=a.a[b],c=vb(f,c,e,d),-1<c&&(sb(f[c]),Array.prototype.splice.call(f,c,1),f.length||(delete a.a[b],a.b--)))):a&&(a=Cb(a))&&(b=a.a[b.toString()],a=-1,b&&(a=vb(b,c,!!e,d)),(c=-1<a?b[a]:null)&&Hb(c))}
function Hb(a){if("number"!=typeof a&&a&&!a.o){var b=a.src;if(b&&b[pb])wb(b.b,a);else{var c=a.type,e=a.a;b.removeEventListener?b.removeEventListener(c,e,a.A):b.detachEvent&&b.detachEvent(Eb(c),e);zb--;(c=Cb(b))?(wb(c,a),c.b||(c.src=null,b[xb]=null)):sb(a)}}}function Eb(a){return a in yb?yb[a]:yb[a]="on"+a}function Ib(a,b,c,e){var d=!0;if(a=Cb(a))if(b=a.a[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.A==c&&!f.o&&(f=Jb(f,e),d=d&&!1!==f)}return d}
function Jb(a,b){var c=a.listener,e=a.B||a.src;a.w&&Hb(a);return c.call(e,b)}
function Fb(a,b){if(a.o)return!0;if(!eb){var c;if(!(c=b))a:{c=["window","event"];for(var e=z,d;d=c.shift();)if(null!=e[d])e=e[d];else{c=null;break a}c=e}d=c;c=new T(d,this);e=!0;if(!(0>d.keyCode||void 0!=d.returnValue)){a:{var f=!1;if(!d.keyCode)try{d.keyCode=-1;break a}catch(k){f=!0}if(f||void 0==d.returnValue)d.returnValue=!0}d=[];for(f=c.a;f;f=f.parentNode)d.push(f);for(var f=a.type,g=d.length-1;0<=g;g--){c.a=d[g];var h=Ib(d[g],f,!0,c),e=e&&h}for(g=0;g<d.length;g++)c.a=d[g],h=Ib(d[g],f,!1,c),e=
e&&h}return e}return Jb(a,new T(b,this))}function Cb(a){a=a[xb];return a instanceof tb?a:null}var Kb="__closure_events_fn_"+(1E9*Math.random()>>>0);function Bb(a){if("function"==ga(a))return a;a[Kb]||(a[Kb]=function(b){return a.handleEvent(b)});return a[Kb]};function U(){Oa.call(this);this.b=new tb(this);this.aa=this;this.I=null}ma(U,Oa);U.prototype[pb]=!0;U.prototype.removeEventListener=function(a,b,c,e){Gb(this,a,b,c,e)};U.prototype.f=function(){U.J.f.call(this);if(this.b){var a=this.b,b=0,c;for(c in a.a){for(var e=a.a[c],d=0;d<e.length;d++)++b,sb(e[d]);delete a.a[c];a.b--}}this.I=null};
function Lb(a,b,c,e){b=a.b.a[String(b)];if(!b)return!0;b=b.concat();for(var d=!0,f=0;f<b.length;++f){var g=b[f];if(g&&!g.o&&g.A==c){var h=g.listener,k=g.B||g.src;g.w&&wb(a.b,g);d=!1!==h.call(k,e)&&d}}return d&&0!=e.P};function V(a,b){U.call(this);this.i=a||1;this.c=b||z;this.l=la(this.ga,this);this.m=J()}ma(V,U);V.prototype.h=!1;V.prototype.a=null;
V.prototype.ga=function(){if(this.h){var a=J()-this.m;if(0<a&&a<.8*this.i)this.a=this.c.setTimeout(this.l,this.i-a);else{this.a&&(this.c.clearTimeout(this.a),this.a=null);var b;if(a=this.I)for(b=[];a;a=a.I)b.push(a);var a=this.aa,c="tick",e=c.type||c;if(F(c))c=new S(c,a);else if(c instanceof S)c.b=c.b||a;else{var d=c,c=new S(e,a);qa(c,d)}var d=!0,f;if(b)for(var g=b.length-1;0<=g;g--)f=c.a=b[g],d=Lb(f,e,!0,c)&&d;f=c.a=a;d=Lb(f,e,!0,c)&&d;d=Lb(f,e,!1,c)&&d;if(b)for(g=0;g<b.length;g++)f=c.a=b[g],d=Lb(f,
e,!1,c)&&d;this.h&&(this.a=this.c.setTimeout(this.l,this.i),this.m=J())}}};V.prototype.f=function(){V.J.f.call(this);this.h=!1;this.a&&(this.c.clearTimeout(this.a),this.a=null);delete this.c};function Mb(){this.a={};this.c=18E5;this.b=null}m=Mb.prototype;m.connect=function(a,b){var c=this.a[a],e=!1;c?(c[b]||(c[b]={v:W(),u:[],D:!1},e=!0),Nb(b,c)):(e=!0,this.a[a]={},this.a[a][b]={v:W(),u:[],D:!1});return e};m.M=function(a,b){var c=this.a[a],e=!1;if(c){e=!!c[b];delete c[b];Nb(b,c);var d=!0,f;for(f in c)if(c.hasOwnProperty(f)){d=!1;break}d&&delete this.a[a]}return e};function Nb(a,b){for(var c in b)b.hasOwnProperty(c)&&c!=a&&(b[c].D=!0)}
m.H=function(a,b){var c=!1;if(a&&b){var e=this.a[a];e&&(c=e[b],c=!(!c||!Ob(this,c.v)))}return c};m.O=function(a,b){var c=this.a[a],e=[];if(c){void 0!==b&&!E(b)&&(b=[b]);for(var d in c)c.hasOwnProperty(d)&&(!b||0>b.indexOf(d))&&e.push(d)}return e};m.ea=function(){if(!this.b){this.b=new V(6E4);Ab(this.b,"tick",this.G,!1,this);var a=this.b;a.h=!0;a.a||(a.a=a.c.setTimeout(a.l,a.i),a.m=J())}};
m.fa=function(){if(this.b){Gb(this.b,"tick",this.G,!1,this);var a=this.b;a.g||(a.g=!0,a.f(),0!=Pa&&(a=a[G]||(a[G]=++ia),delete Qa[a]));this.b=null}};m.G=function(){var a=W();oa(this.a,function(b,c){oa(b,function(b,d){Ob(this,b.v,a)&&this.M(c,d)},this)},this)};m.ca=function(a){this.c=a};m.ba=function(a){this.c=a};m.$=function(a,b,c){if(this.H(a,b)){a=this.a[a];a[b].v=W();for(var e in a)if(a.hasOwnProperty(e)&&e!=b){var d=a[e];d.u=d.u.concat(c)}}};
m.Z=function(a,b){var c=null;if(this.H(a,b)){var e=this.a[a][b],c=[e.u,e.D?this.O(a,b):null];e.u=[];e.D=!1;e.v=W()}return c};function W(){return(new Date).getTime()}function Ob(a,b,c){void 0!==c||(c=W());return b+a.c>c}var X=Mb.prototype;X.connect=X.connect;X.disconnect=X.M;X.collect=X.G;X.isConnected=X.H;X.getConnectedSites=X.O;X.popUpdates=X.Z;X.registerUpdates=X.$;X.startCollectionCycle=X.ea;X.stopCollectionCycle=X.fa;X.setConnectionTimeout=X.ca;X.setCollectionInterval=X.ba;
K("cot.net.Connections",Mb);function Pb(){}function Qb(a,b,c,e){if(b==c)return[[0,b]];"undefined"==typeof e&&(e=!0);var d=Rb(b,c),f=b.substring(0,d);b=b.substring(d);c=c.substring(d);var d=Sb(b,c),g=b.substring(b.length-d);b=b.substring(0,b.length-d);c=c.substring(0,c.length-d);b=Tb(a,b,c,e);f&&b.unshift([0,f]);g&&b.push([0,g]);Ub(a,b);return b}
function Tb(a,b,c,e){var d;if(!b)return[[1,c]];if(!c)return[[-1,b]];var f=b.length>c.length?b:c,g=b.length>c.length?c:b,h=f.indexOf(g);if(-1!=h)return d=[[1,f.substring(0,h)],[0,g],[1,f.substring(h+g.length)]],b.length>c.length&&(d[0][0]=d[2][0]=-1),d;if(f=Vb(b,c)){c=f[1];var k=f[3];b=f[4];d=Qb(a,f[0],f[2],e);a=Qb(a,c,k,e);return d.concat([[0,b]],a)}e&&(100>b.length||100>c.length)&&(e=!1);e&&(k=Wb(b,c),b=k[0],c=k[1],k=k[2]);a:{var f=b,g=c,l=(new Date).getTime()+1E3,h=f.length,n=g.length,p=h+n-1,r=
64<p,q=[],C=[],D={},B={};D[1]=0;B[1]=0;for(var t,u,y={},H=!1,na=!!y.hasOwnProperty,I=(h+n)%2,A=0;A<p&&!((new Date).getTime()>l);A++){q[A]={};for(var x=-A;x<=A;x+=2){t=x==-A||x!=A&&D[x-1]<D[x+1]?D[x+1]:D[x-1]+1;u=t-x;r&&(d=t+","+u,I&&(na?y.hasOwnProperty(d):void 0!==y[d])&&(H=!0),I||(y[d]=A));for(;!H&&t<h&&u<n&&f.charAt(t)==g.charAt(u);)t++,u++,r&&(d=t+","+u,I&&(na?y.hasOwnProperty(d):void 0!==y[d])&&(H=!0),I||(y[d]=A));D[x]=t;q[A][t+","+u]=!0;if(t==h&&u==n){d=Xb(q,f,g);break a}if(H){C=C.slice(0,y[d]+
1);d=Xb(q,f.substring(0,t),g.substring(0,u));d=d.concat(Yb(C,f.substring(t),g.substring(u)));break a}}if(r)for(C[A]={},x=-A;x<=A;x+=2){t=x==-A||x!=A&&B[x-1]<B[x+1]?B[x+1]:B[x-1]+1;u=t-x;d=h-t+","+(n-u);!I&&(na?y.hasOwnProperty(d):void 0!==y[d])&&(H=!0);for(I&&(y[d]=A);!H&&t<h&&u<n&&f.charAt(h-t-1)==g.charAt(n-u-1);)t++,u++,d=h-t+","+(n-u),!I&&(na?y.hasOwnProperty(d):void 0!==y[d])&&(H=!0),I&&(y[d]=A);B[x]=t;C[A][t+","+u]=!0;if(H){q=q.slice(0,y[d]+1);d=Xb(q,f.substring(0,h-t),g.substring(0,n-u));d=
d.concat(Yb(C,f.substring(h-t),g.substring(n-u)));break a}}}d=null}d||(d=[[-1,b],[1,c]]);if(e){e=d;b=k;for(c=0;c<e.length;c++){k=e[c][1];f=[];for(g=0;g<k.length;g++)f[g]=b[k.charCodeAt(g)];e[c][1]=f.join("")}Zb(a,d);d.push([0,""]);c=b=e=0;for(f=k="";e<d.length;){switch(d[e][0]){case 1:c++;f+=d[e][1];break;case -1:b++;k+=d[e][1];break;case 0:if(1<=b&&1<=c){k=Qb(a,k,f,!1);d.splice(e-b-c,b+c);e=e-b-c;for(b=k.length-1;0<=b;b--)d.splice(e,0,k[b]);e+=k.length}b=c=0;f=k=""}e++}d.pop()}return d}
function Wb(a,b){function c(a){for(var b="",c=0,f=-1,g=e.length;f<a.length-1;){f=a.indexOf("\n",c);-1==f&&(f=a.length-1);var r=a.substring(c,f+1),c=f+1;(d.hasOwnProperty?d.hasOwnProperty(r):void 0!==d[r])?b+=String.fromCharCode(d[r]):(b+=String.fromCharCode(g),d[r]=g,e[g++]=r)}return b}var e=[],d={};e[0]="";var f=c(a),g=c(b);return[f,g,e]}
function Xb(a,b,c){for(var e=[],d=b.length,f=c.length,g=null,h=a.length-2;0<=h;h--)for(;;)if(a[h].hasOwnProperty?a[h].hasOwnProperty(d-1+","+f):void 0!==a[h][d-1+","+f]){d--; -1===g?e[0][1]=b.charAt(d)+e[0][1]:e.unshift([-1,b.charAt(d)]);g=-1;break}else if(a[h].hasOwnProperty?a[h].hasOwnProperty(d+","+(f-1)):void 0!==a[h][d+","+(f-1)]){f--;1===g?e[0][1]=c.charAt(f)+e[0][1]:e.unshift([1,c.charAt(f)]);g=1;break}else{d--;f--;if(b.charAt(d)!=c.charAt(f))throw Error("No diagonal.  Can't happen. (diff_path1)");
0===g?e[0][1]=b.charAt(d)+e[0][1]:e.unshift([0,b.charAt(d)]);g=0}return e}
function Yb(a,b,c){for(var e=[],d=0,f=b.length,g=c.length,h=null,k=a.length-2;0<=k;k--)for(;;)if(a[k].hasOwnProperty?a[k].hasOwnProperty(f-1+","+g):void 0!==a[k][f-1+","+g]){f--; -1===h?e[d-1][1]+=b.charAt(b.length-f-1):e[d++]=[-1,b.charAt(b.length-f-1)];h=-1;break}else if(a[k].hasOwnProperty?a[k].hasOwnProperty(f+","+(g-1)):void 0!==a[k][f+","+(g-1)]){g--;1===h?e[d-1][1]+=c.charAt(c.length-g-1):e[d++]=[1,c.charAt(c.length-g-1)];h=1;break}else{f--;g--;if(b.charAt(b.length-f-1)!=c.charAt(c.length-
g-1))throw Error("No diagonal.  Can't happen. (diff_path2)");0===h?e[d-1][1]+=b.charAt(b.length-f-1):e[d++]=[0,b.charAt(b.length-f-1)];h=0}return e}function Rb(a,b){if(!a||!b||a.charCodeAt(0)!==b.charCodeAt(0))return 0;for(var c=0,e=Math.min(a.length,b.length),d=e,f=0;c<d;)a.substring(f,d)==b.substring(f,d)?f=c=d:e=d,d=Math.floor((e-c)/2+c);return d}
function Sb(a,b){if(!a||!b||a.charCodeAt(a.length-1)!==b.charCodeAt(b.length-1))return 0;for(var c=0,e=Math.min(a.length,b.length),d=e,f=0;c<d;)a.substring(a.length-d,a.length-f)==b.substring(b.length-d,b.length-f)?f=c=d:e=d,d=Math.floor((e-c)/2+c);return d}
function Vb(a,b){function c(a,b,c){for(var e=a.substring(c,c+Math.floor(a.length/4)),d=-1,f="",g,h,B,t;-1!=(d=b.indexOf(e,d+1));){var u=Rb(a.substring(c),b.substring(d)),y=Sb(a.substring(0,c),b.substring(0,d));f.length<y+u&&(f=b.substring(d-y,d)+b.substring(d,d+u),g=a.substring(0,c-y),h=a.substring(c+u),B=b.substring(0,d-y),t=b.substring(d+u))}return f.length>=a.length/2?[g,h,B,t,f]:null}var e=a.length>b.length?a:b,d=a.length>b.length?b:a;if(10>e.length||1>d.length)return null;var f=c(e,d,Math.ceil(e.length/
4)),e=c(e,d,Math.ceil(e.length/2)),g;if(f||e)e?g=f?f[4].length>e[4].length?f:e:e:g=f;else return null;var h;a.length>b.length?(f=g[0],e=g[1],d=g[2],h=g[3]):(d=g[0],h=g[1],f=g[2],e=g[3]);return[f,e,d,h,g[4]]}function Zb(a,b){for(var c=!1,e=[],d=0,f=null,g=0,h=0,k=0;g<b.length;)0==b[g][0]?(e[d++]=g,h=k,k=0,f=b[g][1]):(k+=b[g][1].length,null!==f&&f.length<=h&&f.length<=k&&(b.splice(e[d-1],0,[-1,f]),b[e[d-1]+1][0]=1,d--,d--,g=0<d?e[d-1]:-1,k=h=0,f=null,c=!0)),g++;c&&Ub(a,b);$b(b)}
function $b(a){function b(a,b){if(!a||!b)return 5;var h=0;if(a.charAt(a.length-1).match(c)||b.charAt(0).match(c))if(h++,a.charAt(a.length-1).match(e)||b.charAt(0).match(e))if(h++,a.charAt(a.length-1).match(d)||b.charAt(0).match(d))h++,(a.match(f)||b.match(g))&&h++;return h}for(var c=/[^a-zA-Z0-9]/,e=/\s/,d=/[\r\n]/,f=/\n\r?\n$/,g=/^\r?\n\r?\n/,h=1;h<a.length-1;){if(0==a[h-1][0]&&0==a[h+1][0]){var k=a[h-1][1],l=a[h][1],n=a[h+1][1],p=Sb(k,l);if(p)var r=l.substring(l.length-p),k=k.substring(0,k.length-
p),l=r+l.substring(0,l.length-p),n=r+n;for(var p=k,r=l,q=n,C=b(k,l)+b(l,n);l.charAt(0)===n.charAt(0);){var k=k+l.charAt(0),l=l.substring(1)+n.charAt(0),n=n.substring(1),D=b(k,l)+b(l,n);D>=C&&(C=D,p=k,r=l,q=n)}a[h-1][1]!=p&&(p?a[h-1][1]=p:(a.splice(h-1,1),h--),a[h][1]=r,q?a[h+1][1]=q:(a.splice(h+1,1),h--))}h++}}
function Ub(a,b){b.push([0,""]);for(var c=0,e=0,d=0,f="",g="",h;c<b.length;)switch(b[c][0]){case 1:d++;g+=b[c][1];c++;break;case -1:e++;f+=b[c][1];c++;break;case 0:if(e||d){if(e&&d){if(h=Rb(g,f))0<c-e-d&&0==b[c-e-d-1][0]?b[c-e-d-1][1]+=g.substring(0,h):(b.splice(0,0,[0,g.substring(0,h)]),c++),g=g.substring(h),f=f.substring(h);if(h=Sb(g,f))b[c][1]=g.substring(g.length-h)+b[c][1],g=g.substring(0,g.length-h),f=f.substring(0,f.length-h)}e?d?b.splice(c-e-d,e+d,[-1,f],[1,g]):b.splice(c-e-d,e+d,[-1,f]):
b.splice(c-e-d,e+d,[1,g]);c=c-e-d+(e?1:0)+(d?1:0)+1}else c&&0==b[c-1][0]?(b[c-1][1]+=b[c][1],b.splice(c,1)):c++;e=d=0;g=f=""}""===b[b.length-1][1]&&b.pop();e=!1;for(c=1;c<b.length-1;)0==b[c-1][0]&&0==b[c+1][0]&&(b[c][1].substring(b[c][1].length-b[c-1][1].length)==b[c-1][1]?(b[c][1]=b[c-1][1]+b[c][1].substring(0,b[c][1].length-b[c-1][1].length),b[c+1][1]=b[c-1][1]+b[c+1][1],b.splice(c-1,1),e=!0):b[c][1].substring(0,b[c+1][1].length)==b[c+1][1]&&(b[c-1][1]+=b[c+1][1],b[c][1]=b[c][1].substring(b[c+1][1].length)+
b[c+1][1],b.splice(c+1,1),e=!0)),c++;e&&Ub(a,b)};function Y(a,b){return{type:0,at:a,value:b}}function Z(a,b){return{type:1,at:a,value:b}}
var ac=[function(a,b){var c=a.load,e=c.at,d=b.load,f=d.at,d=d.value.length;return e>f||e==f&&a.siteId>b.siteId?Y(e+d,c.value):c},function(a,b){var c=a.load,e=c.at,d=b.load,f=d.at,d=d.value.length;return e>f?e>=f+d?Y(e-d,c.value):null:c},function(a,b){var c=a.load,e=c.at,d=c.value,f=b.load,g=f.at,f=f.value,h=f.length;return e>=g?Z(e+h,d):e+d.length>g?(d=d.substring(0,g-e)+f+d.substring(g-e),Z(e,d)):c},function(a,b){var c=a.load,e=c.at,d=c.value,f=e+d.length-1,g=b.load,h=g.at,g=g.value.length,k=h+g-
1,l=Math.max(h,e),n=Math.min(k,f);if(l<=n){if(l==e&&n==f)return null;d=d.substring(0,l-e)+d.substring(n+1-e);return Z(Math.min(e,h),d)}return e>k?Z(e-g,d):c}],bc=[function(a){return Z(a.load.at,a.load.value)},function(a){return Y(a.load.at,a.load.value)}];function cc(a,b){var c=b.load;if(c){c=dc[c.type];if(!c)throw"Wrong operations passed to an exec function.";a=c(a,b)}return a}
var dc=[function(a,b){var c=b.load,e=c.at;return a.substring(0,e)+c.value+a.substring(e)},function(a,b){var c=b.load,e=c.at;return a.substring(0,e)+a.substring(e+c.value.length)}];function ec(a,b,c){var e=b.load;if(e){e=fc[e.type];if(!e)throw"Wrong operations passed to a moveCursor function.";a=e(a,b,c)}return a}var fc=[function(a,b,c){var e=b.load,d=e.at,e=e.value.length;return a>d||a==d&&b.siteId<c?a+e:a},function(a,b){var c=b.load,e=c.at,c=c.value.length;return a>e?Math.max(e,a-c):a}];
K("cot.ops.string.insert",Y);K("cot.ops.string.remove",Z);K("cot.ops.string.transform",function(a,b){var c=ac[a.load.type<<1|b.load.type];if(!c)throw"Wrong operations passed to a transformation function.";return c(a,b)});K("cot.ops.string.invert",function(a){var b=bc[a.load.type];if(!b)throw"Wrong operations passed to an inversion function.";return b(a)});K("cot.ops.string.exec",function(a,b){if(b)if(E(b))for(var c=0;c<b.length;c++)a=cc(a,b[c]);else a=cc(a,b);return a});
K("cot.ops.string.moveCursor",function(a,b,c){if(b)if(E(b))for(var e=0;e<b.length;e++)a=ec(a,b[e],c);else a=ec(a,b,c);return a});K("cot.ops.string.genOps",function(a,b){var c=new Pb,e=Qb(c,a,b);Zb(c,e);for(var c=0,d=[],f,g=0;g<e.length;g++){var h=e[g];f=h[0];var k=h[1],h=k.length;f?(-1==f?f=Z(c,k):(f=Y(c,k),c+=h),d.push(f)):c+=h}return d});K("cot.ops.string.OpType.INSERT",0);K("cot.ops.string.OpType.REMOVE",1);}).call(this);
